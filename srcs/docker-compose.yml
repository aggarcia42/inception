version: "3"
services:
 nginx:
    container_name: nginx
    build:
        context: ./requirements/nginx/
        dockerfile: Dockerfile
    ports:
        - 443:443
    env_file: 
        - .env
    networks:
        - mynetwork
    depends_on:
        - wordpress
    volumes:
        - wordpress-files:/var/www/html
    restart: unless-stopped

 wordpress:
    container_name: wordpress
    build:
        context: ./requirements/wordpress/
        dockerfile: Dockerfile
    depends_on:
        - mariadb
    volumes:
        - wordpress-files:/var/www/html
    env_file: 
        - .env
    networks:
        - mynetwork
    restart: unless-stopped

 mariadb:
    container_name: mariadb
    build:
        context: ./requirements/mariadb/
        dockerfile: Dockerfile
    volumes:
        - mariadb-data:/var/lib/mysql
    env_file: 
        - .env
    networks:
        - mynetwork
    restart: unless-stopped

volumes:
    wordpress-files:
        name: wordpress
        driver: local
        driver_opts:
            type: none
            device: $HOME/data/wordpress
            o: bind
    mariadb-data:
        name: mariadb
        driver: local
        driver_opts:
            type: none
            device: $HOME/data/mysql
            o: bind

networks:
    mynetwork:
        name: "inception"